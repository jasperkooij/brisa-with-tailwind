var h=(Z=[])=>Z.join("/"),f=(Z)=>Z.split("/");function n(Z,B,W){const j=new URL(B,"http://l"),x=f(j.pathname);for(let[R,v]of Object.entries(Z)){let A=function(){const $=v[W]??R,F=z.r??[],y=h(f($).map((J,Y)=>q.has(Y)?F.shift():J));return(C&&x.length>Q?`${y}/${h(x.slice(Q))}`:y)+j.search+j.hash};const k=f(R),C=k.at(-1)?.includes("[..."),q=new Set,Q=k.length,H=Q-1;for(let $=0;$<Q;$++)if(k[$].startsWith("["))q.add($);const z=Object.groupBy(x,($,F)=>q.has(F)||!(C&&F<H)&&C?"r":"k"),M=($,F)=>!q.has(F),U=h(z.k),T=h(k.filter(M));if(U===T)return A();if(Object.values(v).some(($)=>h(f($).filter(M))===U))return A()}}function r(Z,B){while(Z){if(Z.tagName==="CONTEXT-PROVIDER"&&B===Z.getAttribute("cid")){const W=Z.getAttribute("pid");if(W)return W}Z=Z.assignedSlot??Z.host??Z.parentNode}return null}function BJ(Z){return typeof Z!=="object"?Z:JSON.stringify(Z,(B,W)=>W===void 0?"_|U|_":W)}function l(Z){if(!Z)return Z;try{return JSON.parse(Z,(B,W)=>W==="_|U|_"?void 0:W)}catch(B){return Z}}function xJ(){const Z=new Set;return{["s"](B){Z.add(B)},["n"](...B){for(let W of Z)W(...B)},["u"](B){Z.delete(B)}}}var a=window,g=a._s??={Map:new Map};for(let[Z,B]of a._S??[])g.Map.set(Z,B);var s=a.sub??=xJ();for(let Z of["get","set","delete"])g[Z]=(B,W)=>{const j=g.Map[Z](B,W);return s.n(B,W,Z==="get"),j};function d(){const Z=[],B=new Map,W=(J,Y)=>J.get(Y)??new Set,j=new Map,x=new Map,R=new Map;let v=!1;function k(J,Y,X){const D=B.get(J)??z(Y);X?D.value:D.value=Y,B.set(J,D)}function C(J){const Y=Z.indexOf(J);if(Y>-1)Z.splice(Y,1)}function q(J){const Y=W(x,J);for(let X of Y)X();x.delete(J)}function Q(J){const Y=(X)=>{const D=W(R,J);return D.add(X),R.set(J,D),X};return Y.id=J,Y}function H(J){const Y=W(R,J);for(let X of Y){q(X),H(X);for(let D of j.keys()){const O=j.get(D);if(O.delete(X),O.size===0)j.delete(D)}}R.delete(J)}function z(J){return{get value(){if(Z[0])j.set(this,W(j,this).add(Z[0]));return J},set value(Y){const X=Y===J&&Y!=null;if(J=Y,X)return;const D=W(j,this),O=new Set(D);for(let I of D){if(I===Z[0])continue;if(O.has(I))H(I),q(I),M(I)}}}}async function M(J){Z.unshift(J);const Y=J(Q(J));if(Y?.then)await Y;C(J)}function A(){for(let J of x.keys())q(J);x.clear(),j.clear(),R.clear(),U(!1)}function U(J=!0){if(v===J)return;v=J,s[J?"s":"u"](k)}function T(J,Y){const X=W(x,Y);X.add(J),x.set(Y,X)}function $(J){const Y=z();return M(()=>{Y.value=J()}),Y}const F={...g,setOptimistic(J,Y,X){const D="__ind:"+J,O="__o:"+Y,I=F.get(Y),G=X(I);F.set(D,!0),F.set(O,G),M(()=>{if(!F.get(D)&&F.get(Y)===G)F.delete(O)})},get(J){return U(),g.get("__o:"+J)??g.get(J)},has(J){return F.get(J)!==void 0}};function y(J){const Y="__ind:"+J,X=$(()=>!!F.get(Y));return X.id=Y,X.error=$(()=>F.get("e"+Y)),X}return{state:z,store:F,effect:M,reset:A,cleanup:T,derived:$,indicate:y}}var m=(Z)=>Z.toLowerCase();function t(Z){let B="";for(let W in Z){const j=m(W.replace(/([A-Z])/g,"-$1"));B+=`${j}:${Z[W]};`}return B}var GJ=Symbol("on"),KJ=Symbol("off"),MJ="http://www.w3.org/",e=MJ+"2000/svg",DJ=MJ+"1999/xlink",YJ="HTML",HJ="indicator",UJ="brisa-request",RJ="portal",JJ="slot",$J="key",XJ="connectedCallback",jJ="dis"+XJ,ZJ="inner"+YJ,zJ="p",c="l",S=null,TJ="context",IJ=(Z)=>typeof Z==="object",i=(Z)=>Z?.some?.(IJ),qJ=Array.from,FJ=(Z)=>Z instanceof CustomEvent,p=(Z)=>typeof Z==="function",QJ=(Z)=>Z.startsWith("on"),b=(Z,B)=>Z.appendChild(B);function _J(Z,B=[]){const W=document,j=window,x=(q)=>{if(q===!1)q="";return W.createTextNode((Array.isArray(q)?q.join(""):q??"").toString())};if(__TRAILING_SLASH__||__USE_LOCALE__||__USE_PAGE_TRANSLATION__)j.fPath??=(q)=>{let Q=q;if(__USE_LOCALE__||__USE_PAGE_TRANSLATION__){const{locales:z,locale:M,pages:A}=j.i18n,U=Q.split(/\/|#|\?/)[1],T=z.includes(U);if(__USE_PAGE_TRANSLATION__){const $=n(A,Q,T?U:M);if($)Q=$}Q=T?Q:"/"+M+Q}const H=/\/(?=\?|#|$)/;if(__TRAILING_SLASH__){if(Q=Q.replace(/([^/])([?#])/,"$1/$2"),!Q.match(H))Q+="/"}else Q=Q.replace(H,"");return Q};const R=(q,Q)=>{return q==="svg"||Q?.namespaceURI===e&&m(Q.tagName)!=="foreignobject"?W.createElementNS(e,q):W.createElement(q)},v=(q,Q,H)=>{const z=H===GJ,M=H===KJ;let U=Q==="style"&&IJ(H)?t(H):BJ(H);const T=q.namespaceURI===e&&(Q.startsWith("xlink:")||Q==="href");if(__BASE_PATH__||__TRAILING_SLASH__||__USE_LOCALE__||__USE_PAGE_TRANSLATION__||__ASSET_PREFIX__){if((Q==="src"||Q==="href")&&!URL.canParse(U)){if((__TRAILING_SLASH__||__USE_LOCALE__||__USE_PAGE_TRANSLATION__)&&Q==="href")U=j.fPath(U);if(__ASSET_PREFIX__&&Q==="src")U=__ASSET_PREFIX__+U;if(__BASE_PATH__&&!URL.canParse(U))U=__BASE_PATH__+U}}if(Q===HJ)if(H)q.classList.add(UJ);else q.classList.remove(UJ);else if(Q==="ref")H.value=q;else if(T)if(M)q.removeAttributeNS(DJ,Q);else q.setAttributeNS(DJ,Q,z?"":U);else if(M)q.removeAttribute(Q);else q.setAttribute(Q,z?"":U)},k=[],C={};B.push($J);for(let q of B){const Q=m(q);C[Q]=C[q]=q,k.push(Q)}return class extends HTMLElement{p;l;s;static get observedAttributes(){return k}static formAssociated=!0;async[XJ](){const q=this,Q=q.shadowRoot??q.attachShadow({mode:"open"}),H=[],z=[],M=new CSSStyleSheet;let A=0;const U=[];for(let J of W.styleSheets)try{for(let Y of J.cssRules)U.push(Y.cssText)}catch(Y){U.push(`@import url('${J.href}');`)}M.replaceSync(U.join("")),Q.adoptedStyleSheets.push(M);function T(J,Y){if(J?.[0]!==RJ)return[J,Y];const{element:X,target:D}=J[1];return[X,D]}async function $(J,Y,X,D,O,I,G=!1){if(X?.then)X=await X;if(G){if(q.shadowRoot)q.shadowRoot[ZJ]="";if(z.length){const _=R("style");I(()=>{let w="";for(let[P,...V]of z)w+=String.raw(P,...V.map((L)=>p(L)?L():L));_.textContent=w}),b(Q,_)}}[X,D]=T(X,D);let K=J?R(J,D):D;for(let[_,w]of Object.entries(Y)){const P=QJ(_),V=_===HJ;if(P)K.addEventListener(m(_.slice(2)),(L)=>w.apply(null,FJ(L)?L.detail:[L]));else if(V||!P&&p(w))I(O(()=>v(K,_,V?w?.value:w())));else v(K,_,w)}if(X?.[0]===YJ)K[ZJ]+=X[1].html;else if(X===JJ)b(K,R(JJ));else if(i(X))if(i(X[0]))for(let _ of X)$(S,{},_,K,O,I);else $(...X,K,O,I);else if(p(X)){let _;const w=(P)=>{if(_&&K.contains(_[0])){K.insertBefore(P,_[0]);for(let V of _)V?.remove()}else b(K,P)};I(O((P)=>{const V=X();function L(N){[N,K]=T(N,K);const WJ=N?.[0]===YJ;if(WJ||i(N)){const o=qJ(K.childNodes),u=W.createDocumentFragment();if(WJ){const E=R("p");E[ZJ]+=N[1].html;for(let OJ of qJ(E.childNodes))b(u,OJ)}else if(i(N[0]))for(let E of N)$(S,{},E,u,O(P),I);else if(N.length)$(...N,u,O(P),I);w(u),_=qJ(K.childNodes).filter((E)=>!o.includes(E))}else{const o=x(N);w(o),_=[o]}}if(V instanceof Promise)V.then(L);else L(V)}))}else b(K,x(X));if(J)b(D,K)}const F=(J,Y,X=d(),D=zJ)=>{q.s=X,q[D]={};for(let G of B)q[D][C[G]]=QJ(G)?q.e(G):X.state(l(q.getAttribute(G)));const O={children:[JJ,{},S],...q[D],...Y},I={...X,onMount(G){H.push(G)},useId(){return q.dataset[`id-${++A}`]??crypto.randomUUID()},useContext(G){return X.derived(()=>{const K=r(q,G.id);return K?X.store.get(`${TJ}:${G.id}:${K}`):G.defaultValue})},css(G,...K){z.push([G,...K])},i18n:j.i18n,route:j.r,self:q};if(__WEB_CONTEXT_PLUGINS__)for(let G of j._P)Object.assign(I,G(I));return z.length=0,$(S,{},J(O,I),Q,(G)=>G,X.effect,!0)},y=d();try{if(p(Z.suspense))await F(Z.suspense,S,y,c);await F(Z),y.reset(),delete q[c]}catch(J){if(y.reset(),q.s.reset(),p(Z.error))F(Z.error,{error:q.s.state(J)});else throw J}for(let J of H)J()}[jJ](){this.s?.reset()}e(q){return(...Q)=>{const H=new CustomEvent(m(q.slice(2)),{detail:FJ(Q?.[0])?Q[0].detail:Q});this.dispatchEvent(H)}}attributeChangedCallback(q,Q,H){const z=this,M=z[c]?c:zJ;if(q===$J&&Q!=S&&Q!==H)z[jJ](),z[XJ]();if(z[M]&&Q!==H&&!QJ(q))z[M][C[q]].value=l(H)}}}export{_J as brisaElement,GJ as _on,KJ as _off};
